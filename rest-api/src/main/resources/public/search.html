<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Recherche de cours</title>
</head>
<body>
    <h1>Rechercher un cours</h1>
    <a class=button href="index.html"> Retour au menu principal</a>
    <h3>Chercher un cours par mots clé</h3>
    <input type="text" id="searchQueryInput" placeholder="Ex: informatique">
    <button onclick="searchCourseByQuery()">Chercher</button>
    
    <h3>Chercher un cours par sigle</h3>
    <input type="text" id="searchIdInput" placeholder="Ex: IFT2255 ou IFT">
    <button onclick="searchCourseById()">Chercher</button>
    
    <div id="resultDiv"> </div>
    
    
    <script>
        function searchCourseByQuery() {
            const query = document.getElementById("searchQueryInput").value.trim();
            const resultDiv = document.getElementById("resultDiv");

            //Appel à API
            fetch(`/courses/search?query=${encodeURIComponent(query)}`)
                .then(res => res.json())
                .then(courses => {
                    if (courses.length === 0) {
                        resultDiv.textContent = "Aucun cours trouvé.";
                        return;
                    }
                    resultDiv.innerHTML = courses.map(cours => `
                        <div>
                            <strong>ID :</strong> ${cours.id} <br>
                            <strong>Titre :</strong> ${cours.name} <br>
                            <strong>Description :</strong> ${cours.description} <br>
                            <hr>
                        </div>
                    `).join("");
                });
        }
        function searchCourseById(){
            const query = document.getElementById("searchIdInput").value.trim().toUpperCase();
            const resultDiv = document.getElementById("resultDiv");

            fetch(`/courses/search`)
                .then(res => res.json())
                .then(courses => {
                    const filtered = courses.filter(cours => cours.id.toUpperCase().startsWith(query));
                    if (filtered.length === 0){
                        resultDiv.textContent = "Aucun cours trouvé pour ce sigle.";
                        return;
                    }
                    resultDiv.innerHTML = filtered.map(cours => `
                    <div>
                        <strong>ID :</strong> ${cours.id} <br>
                            <strong>Titre :</strong> ${cours.name} <br>
                            <strong>Description :</strong> ${cours.description} <br>
                            <hr>
                        </div>
                    `).join("");
                });  
        }
    </script>
</body>
</html>